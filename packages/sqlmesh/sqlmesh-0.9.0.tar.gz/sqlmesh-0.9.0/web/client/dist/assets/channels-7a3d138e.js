import{r as u,l as Y,z as de,o as N,L as X,I as Z,y as ee,D as re,R as y,au as Te,av as ce,b as $,x as ae,g as W,N as se,p as $e,t as Ae,w as Se,aw as De,aN as Oe,k as Ie,e as le,u as Fe,A as Le,S as n,U as k,a0 as m,aO as _e,aP as Me,aQ as me,H as Ge,aD as A,a5 as ie,aR as He,aS as Ue,aH as We,ax as pe,G as ze,O as oe,aJ as Be,Q as Je,aE as fe,aF as xe,aA as B}from"./index-2ae943fc.js";function Ke({container:e,accept:t,walk:r,enabled:a=!0}){let s=u.useRef(t),o=u.useRef(r);u.useEffect(()=>{s.current=t,o.current=r},[t,r]),Y(()=>{if(!e||!a)return;let l=de(e);if(!l)return;let c=s.current,d=o.current,b=Object.assign(j=>c(j),{acceptNode:c}),T=l.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,b,!1);for(;T.nextNode();)d(T.currentNode)},[e,a,s,o])}function he(e={},t=null,r=[]){for(let[a,s]of Object.entries(e))ge(r,ve(t,a),s);return r}function ve(e,t){return e?e+"["+t+"]":t}function ge(e,t,r){if(Array.isArray(r))for(let[a,s]of r.entries())ge(e,ve(t,a.toString()),s);else r instanceof Date?e.push([t,r.toISOString()]):typeof r=="boolean"?e.push([t,r?"1":"0"]):typeof r=="string"?e.push([t,r]):typeof r=="number"?e.push([t,`${r}`]):r==null?e.push([t,""]):he(r,t,e)}function Qe(e){var t;let r=(t=e==null?void 0:e.form)!=null?t:e.closest("form");if(r){for(let a of r.elements)if(a.tagName==="INPUT"&&a.type==="submit"||a.tagName==="BUTTON"&&a.type==="submit"||a.nodeName==="INPUT"&&a.type==="image"){a.click();return}}}function qe(e,t,r){let[a,s]=u.useState(r),o=e!==void 0,l=u.useRef(o),c=u.useRef(!1),d=u.useRef(!1);return o&&!l.current&&!c.current?(c.current=!0,l.current=o,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!o&&l.current&&!d.current&&(d.current=!0,l.current=o,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[o?e:a,N(b=>(o||s(b),t==null?void 0:t(b)))]}let be=u.createContext(null);function we(){let e=u.useContext(be);if(e===null){let t=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(t,we),t}return e}function je(){let[e,t]=u.useState([]);return[e.length>0?e.join(" "):void 0,u.useMemo(()=>function(r){let a=N(o=>(t(l=>[...l,o]),()=>t(l=>{let c=l.slice(),d=c.indexOf(o);return d!==-1&&c.splice(d,1),c}))),s=u.useMemo(()=>({register:a,slot:r.slot,name:r.name,props:r.props}),[a,r.slot,r.name,r.props]);return y.createElement(be.Provider,{value:s},r.children)},[t])]}let Ve="label";function Ye(e,t){let r=Z(),{id:a=`headlessui-label-${r}`,passive:s=!1,...o}=e,l=we(),c=ee(t);Y(()=>l.register(a),[a,l.register]);let d={ref:c,...l.props,id:a};return s&&("onClick"in d&&(delete d.htmlFor,delete d.onClick),"onClick"in o&&delete o.onClick),re({ourProps:d,theirProps:o,slot:l.slot||{},defaultTag:Ve,name:l.name||"Label"})}let Xe=X(Ye),Ze=Object.assign(Xe,{});var er=(e=>(e[e.RegisterOption=0]="RegisterOption",e[e.UnregisterOption=1]="UnregisterOption",e))(er||{});let rr={[0](e,t){let r=[...e.options,{id:t.id,element:t.element,propsRef:t.propsRef}];return{...e,options:Le(r,a=>a.element.current)}},[1](e,t){let r=e.options.slice(),a=e.options.findIndex(s=>s.id===t.id);return a===-1?e:(r.splice(a,1),{...e,options:r})}},te=u.createContext(null);te.displayName="RadioGroupDataContext";function Ne(e){let t=u.useContext(te);if(t===null){let r=new Error(`<${e} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Ne),r}return t}let ne=u.createContext(null);ne.displayName="RadioGroupActionsContext";function ke(e){let t=u.useContext(ne);if(t===null){let r=new Error(`<${e} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,ke),r}return t}function tr(e,t){return Fe(t.type,rr,e,t)}let nr="div";function ar(e,t){let r=Z(),{id:a=`headlessui-radiogroup-${r}`,value:s,defaultValue:o,name:l,onChange:c,by:d=(i,x)=>i===x,disabled:b=!1,...T}=e,j=N(typeof d=="string"?(i,x)=>{let f=d;return(i==null?void 0:i[f])===(x==null?void 0:x[f])}:d),[S,F]=u.useReducer(tr,{options:[]}),h=S.options,[K,L]=je(),[Q,E]=ce(),R=u.useRef(null),q=ee(R,t),[g,_]=qe(s,c,o),M=u.useMemo(()=>h.find(i=>!i.propsRef.current.disabled),[h]),w=u.useMemo(()=>h.some(i=>j(i.propsRef.current.value,g)),[h,g]),v=N(i=>{var x;if(b||j(i,g))return!1;let f=(x=h.find(C=>j(C.propsRef.current.value,i)))==null?void 0:x.propsRef.current;return f!=null&&f.disabled?!1:(_==null||_(i),!0)});Ke({container:R.current,accept(i){return i.getAttribute("role")==="radio"?NodeFilter.FILTER_REJECT:i.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(i){i.setAttribute("role","none")}});let V=N(i=>{let x=R.current;if(!x)return;let f=de(x),C=h.filter(p=>p.propsRef.current.disabled===!1).map(p=>p.element.current);switch(i.key){case $.Enter:Qe(i.currentTarget);break;case $.ArrowLeft:case $.ArrowUp:if(i.preventDefault(),i.stopPropagation(),ae(C,W.Previous|W.WrapAround)===se.Success){let p=h.find(D=>D.element.current===(f==null?void 0:f.activeElement));p&&v(p.propsRef.current.value)}break;case $.ArrowRight:case $.ArrowDown:if(i.preventDefault(),i.stopPropagation(),ae(C,W.Next|W.WrapAround)===se.Success){let p=h.find(D=>D.element.current===(f==null?void 0:f.activeElement));p&&v(p.propsRef.current.value)}break;case $.Space:{i.preventDefault(),i.stopPropagation();let p=h.find(D=>D.element.current===(f==null?void 0:f.activeElement));p&&v(p.propsRef.current.value)}break}}),G=N(i=>(F({type:0,...i}),()=>F({type:1,id:i.id}))),P=u.useMemo(()=>({value:g,firstOption:M,containsCheckedOption:w,disabled:b,compare:j,...S}),[g,M,w,b,j,S]),H=u.useMemo(()=>({registerOption:G,change:v}),[G,v]),Re={ref:q,id:a,role:"radiogroup","aria-labelledby":K,"aria-describedby":Q,onKeyDown:V},Pe=u.useMemo(()=>({value:g}),[g]),U=u.useRef(null),Ce=$e();return u.useEffect(()=>{U.current&&o!==void 0&&Ce.addEventListener(U.current,"reset",()=>{v(o)})},[U,v]),y.createElement(E,{name:"RadioGroup.Description"},y.createElement(L,{name:"RadioGroup.Label"},y.createElement(ne.Provider,{value:H},y.createElement(te.Provider,{value:P},l!=null&&g!=null&&he({[l]:g}).map(([i,x],f)=>y.createElement(Ae,{features:Se.Hidden,ref:f===0?C=>{var p;U.current=(p=C==null?void 0:C.closest("form"))!=null?p:null}:void 0,...De({key:i,as:"input",type:"radio",checked:x!=null,hidden:!0,readOnly:!0,name:i,value:x})})),re({ourProps:Re,theirProps:T,slot:Pe,defaultTag:nr,name:"RadioGroup"})))))}var sr=(e=>(e[e.Empty=1]="Empty",e[e.Active=2]="Active",e))(sr||{});let lr="div";function ir(e,t){var r;let a=Z(),{id:s=`headlessui-radiogroup-option-${a}`,value:o,disabled:l=!1,...c}=e,d=u.useRef(null),b=ee(d,t),[T,j]=je(),[S,F]=ce(),{addFlag:h,removeFlag:K,hasFlag:L}=Oe(1),Q=Ie({value:o,disabled:l}),E=Ne("RadioGroup.Option"),R=ke("RadioGroup.Option");Y(()=>R.registerOption({id:s,element:d,propsRef:Q}),[s,R,d,e]);let q=N(P=>{var H;if(le(P.currentTarget))return P.preventDefault();R.change(o)&&(h(2),(H=d.current)==null||H.focus())}),g=N(P=>{if(le(P.currentTarget))return P.preventDefault();h(2)}),_=N(()=>K(2)),M=((r=E.firstOption)==null?void 0:r.id)===s,w=E.disabled||l,v=E.compare(E.value,o),V={ref:b,id:s,role:"radio","aria-checked":v?"true":"false","aria-labelledby":T,"aria-describedby":S,"aria-disabled":w?!0:void 0,tabIndex:(()=>w?-1:v||!E.containsCheckedOption&&M?0:-1)(),onClick:w?void 0:q,onFocus:w?void 0:g,onBlur:w?void 0:_},G=u.useMemo(()=>({checked:v,disabled:w,active:L(2)}),[v,w,L]);return y.createElement(F,{name:"RadioGroup.Description"},y.createElement(j,{name:"RadioGroup.Label"},re({ourProps:V,theirProps:c,slot:G,defaultTag:lr,name:"RadioGroup.Option"})))}let or=X(ar),ur=X(ir),z=Object.assign(or,{Option:ur,Label:Ze,Description:Te});function I({children:e,headline:t,type:r,className:a}){return n.jsxs("div",{className:k("flex flex-col rounded-md p-4 overflow-auto scrollbar scrollbar--vertical scrollbar--horizontal",r===m.Add&&"bg-success-10",r===m.Remove&&"bg-danger-10",r===m.Direct&&"bg-secondary-10",r===m.Indirect&&"bg-warning-10",r==="metadata"&&"bg-neutral-10",a),children:[t!=null&&n.jsx("h4",{className:k("mb-2 font-bold whitespace-nowrap",r===m.Add&&"text-success-600 dark:text-success-300",r===m.Remove&&"text-danger-600 dark:text-danger-300",r===m.Direct&&"text-secondary-600 dark:text-secondary-300",r===m.Indirect&&"text-warning-600 dark:text-warning-300",r===m.Metadata&&"text-neutral-600 dark:text-neutral-300"),children:t}),e]})}function dr({changes:e=[],type:t}){return n.jsx("ul",{children:e.map(r=>n.jsxs("li",{className:k("flex items-center px-1 leading-5",t===m.Add&&"text-success-600 dark:text-success-300",t===m.Remove&&"text-danger-600 dark:text-danger-300",t===m.Direct&&"text-secondary-600 dark:text-secondary-300",t===m.Indirect&&"text-warning-600 dark:text-warning-300",t===m.Metadata&&"text-neutral-600 dark:text-neutral-300"),children:[t===m.Add?n.jsx(_e,{className:"h-3 mr-2"}):t===m.Remove?n.jsx(Me,{className:"h-3 mr-2"}):n.jsx(me,{className:"h-4 mr-2"}),n.jsx("small",{children:r})]},r))})}function cr({changes:e=[]}){const t=Ge(r=>r.models);return n.jsx("ul",{children:e.map(r=>n.jsx("li",{className:"text-secondary-500 dark:text-primary-500",children:n.jsx(A,{children:({open:a})=>n.jsxs(n.Fragment,{children:[n.jsxs(A.Button,{className:"flex items-start w-full justify-between rounded-lg text-left",children:[n.jsx("div",{className:"w-full",children:n.jsx(J,{model_name:r.model_name})}),(()=>{const s=a?fe:xe;return n.jsx(s,{className:"max-h-[1rem] min-w-[1rem] dark:text-primary-500 mt-0.5"})})()]}),n.jsxs(A.Panel,{className:"text-sm px-4 mb-4",children:[n.jsx(ye,{type:"indirect",models:r.indirect??[]}),n.jsx(ie,{className:"border-neutral-200 mt-2"}),n.jsx(mr,{change:r}),n.jsx(ie,{className:"border-neutral-200 mt-2"}),(r==null?void 0:r.diff)!=null&&n.jsx(Ee,{diff:r==null?void 0:r.diff}),(()=>{const s=t.get(r.model_name);return s==null?n.jsx(n.Fragment,{}):n.jsx("div",{className:"h-[16rem] bg-theme-lighter rounded-xl p-2",children:n.jsx(He,{withColumns:!1,children:n.jsx(Ue,{model:s,fingerprint:s.id,highlightedNodes:{"border-4 border-secondary-500":[s.name],"border-4 border-warning-500":r.indirect??[],"*":["opacity-50 hover:opacity-100"]}})})})})()]})]})})},r.model_name))})}function mr({change:e}){var o;const t=We(),{change_categorization:r,categories:a}=pe(),s=ze(l=>l.state);return n.jsx(z,{className:k("flex flex-col mt-2",s===oe.Finished?"opacity-50 cursor-not-allowed":"cursor-pointer"),value:(o=r.get(e.model_name))==null?void 0:o.category,onChange:l=>{t({type:Be.Category,category:l,change:e})},disabled:s===oe.Finished,children:a.map(l=>n.jsx(z.Option,{value:l,className:()=>k("relative flex rounded-md"),children:({checked:c})=>n.jsxs("div",{className:k("text-sm flex px-2 py-1 w-full rounded-lg",c?"text-secondary-500 dark:text-primary-300":"text-prose"),children:[n.jsx("div",{className:"mt-[0.125rem] mr-2 border-2 border-neutral-400 min-w-[1rem] h-4 rounded-full flex justify-center items-center",children:c&&n.jsx("span",{className:"inline-block w-2 h-2 bg-secondary-500 dark:bg-primary-300 rounded-full"})}),n.jsxs("div",{children:[n.jsx(z.Label,{as:"p",children:l.name}),n.jsx(z.Description,{as:"span",className:"text-xs text-neutral-500",children:l.description})]})]})},l.name))})}function pr({changes:e=[]}){return n.jsx("ul",{children:e.map(t=>n.jsx("li",{className:"text-warning-700 dark:text-warning-500",children:Je(t.direct)?n.jsx(A,{children:({open:r})=>n.jsxs(n.Fragment,{children:[n.jsxs(A.Button,{className:"flex items-center w-full justify-between rounded-lg text-left",children:[n.jsx(J,{model_name:t.model_name}),(()=>{const a=r?fe:xe;return n.jsx(a,{className:"max-h-[1rem] min-w-[1rem] dark:text-primary-500 mt-0.5"})})()]}),n.jsx(A.Panel,{className:"text-sm px-4 mb-4",children:n.jsx(ye,{type:"direct",models:t.direct??[]})})]})}):n.jsx(J,{model_name:t.model_name})},t.model_name))})}function J({model_name:e}){var a;const{change_categorization:t}=pe(),r=(a=t.get(e))==null?void 0:a.category;return n.jsxs("div",{className:"flex items-center font-bold",children:[n.jsx(me,{className:"h-4 mr-2"}),n.jsx("small",{className:"inline-block text-sm ",children:e}),r!=null&&n.jsx("span",{className:"ml-2 text-xs px-1 bg-neutral-400 text-neutral-100  dark:bg-neutral-400 dark:text-neutral-800 rounded whitespace-nowrap mr-2",children:r.name})]})}function ye({type:e,models:t}){return n.jsx("ul",{className:k("mt-2 ml-4",e==="indirect"&&"text-warning-700 dark:text-warning-500",e==="direct"&&"text-secondary-500 dark:text-primary-500"),children:t.map(r=>n.jsxs("li",{className:"flex",children:[n.jsx("span",{className:k("h-3 w-3 border-l-2 border-b-2 innline-block mr-2")}),r]},r))})}function Ee({diff:e}){return n.jsx("div",{className:"my-4 bg-dark-lighter rounded-lg overflow-hidden",children:n.jsx("pre",{className:"p-4 text-primary-100 max-h-[30vh] overflow-auto scrollbar scrollbar--vertical scrollbar--horizontal",children:e.split(`
`).map((t,r)=>n.jsx("p",{className:k(t.startsWith("+")&&"text-success-500 bg-success-500/10 px-2",t.startsWith("-")&&"text-danger-500 bg-danger-500/10 px-2",t.startsWith("@@")&&"text-primary-300 my-5 px-2"),children:t},`${t}-${r}`))})})}I.Default=dr;I.Direct=cr;I.Indirect=pr;I.Diff=Ee;I.Title=J;const ue=hr("/api/events"),O=new Map;function gr(){return[(e,t)=>fr(e,t)]}function fr(e,t){if(B(e)||O.has(e))return O.get(e);const r=xr(e,t);return ue.addEventListener(e,r),O.set(e,()=>{ue.removeEventListener(e,r),O.delete(e)}),O.get(e)}function xr(e,t){return r=>{if(!(B(e)||B(t)||B(r.data)))try{t(JSON.parse(r.data))}catch(a){console.warn(a)}}}function hr(e){return new EventSource(e)}export{Ke as F,je as H,Ze as M,I as P,qe as T,Qe as p,gr as u};
