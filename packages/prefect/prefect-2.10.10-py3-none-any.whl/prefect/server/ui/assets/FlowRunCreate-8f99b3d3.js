import{aF as k,d as D,g as I,O,aG as F,c as m,aH as N,R as b,i as t,a as x,w as d,k as J,h as V,E as B,o as P,n as i,aI as T,aJ as K,aK as L,aL as U,Y as y,aD as f}from"./index-b49daa9a.js";import{u as z}from"./usePageTitle-bc6dd77f.js";class A extends k{parse(a){return JSON.parse(decodeURIComponent(a??""))}format(a){return encodeURIComponent(JSON.stringify(a))}}const H=D({__name:"FlowRunCreate",setup(w){const a=I(),s=O("deploymentId"),n=B(),c=F("parameters",A,void 0),R=m(()=>!e.value||!c.value?{}:N.map("SchemaValuesResponse",{schema:e.value.parameterOpenApiSchema,values:c.value},"SchemaValues")),_=b(a.deployments.getDeployment,[s]),e=m(()=>_.response),h=async r=>{var l,o;try{const u=await a.deployments.createDeploymentFlowRun(s.value,r),p=((o=(l=r.state)==null?void 0:l.stateDetails)==null?void 0:o.scheduledTime)??void 0,g=!p,S=L(U,{flowRun:u,flowRunRoute:y.flowRun,router:n,immediate:g,startTime:p});f(S,"success"),n.push(y.deployment(s.value))}catch(u){f("Something went wrong trying to create a flow run","error"),console.error(u)}},v=()=>{n.back()},C=m(()=>e.value?`Create Flow Run for Deployment: ${e.value.name}`:"Create Flow Run for Deployment");return z(C),(r,l)=>{const o=V("p-layout-default");return t(e)?(P(),x(o,{key:0},{header:d(()=>[i(t(T),{deployment:t(e)},null,8,["deployment"])]),default:d(()=>[i(t(K),{deployment:t(e),parameters:t(R),onSubmit:h,onCancel:v},null,8,["deployment","parameters"])]),_:1})):J("",!0)}}});export{H as default};
